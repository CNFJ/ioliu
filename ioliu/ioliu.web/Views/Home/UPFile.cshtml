@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model IEnumerable<ioliu.domain.Img>
@{
}
<form action="~/Home/UPFile/?handler=Upload"
      enctype="multipart/form-data"
      onsubmit="AJAXSubmit(this); return false;"
      method="post"
      >
    <dl>
        <dt>
            <label for="FileUpload_FormFile">File</label>
        </dt>
        <dd>
            <input id="FileUpload_FormFile" type="file" name="files" multiple/>
        </dd>
    </dl>
    <input class="btn" type="submit" value="Upload" />
    <div style="margin-top:15px">
        <output name="result"></output>
    </div>
</form>
<table>
    <thead>
        <tr>
            <td>ID</td>
            <td>名称</td>
            <td>路径</td>
            <td>分组</td>
        </tr>
    </thead>
    <tbody>
        @foreach (var imgs in Model)
        {
            <tr>
                <td>@imgs.id</td>
                <td>@imgs.imgName</td>
                <td>@imgs.imgPath</td>
                <td>@imgs.GroupName</td>
            </tr>
        }

    </tbody>
</table>
<script>
    async function AJAXSubmit(oFormElement) {
        var resultElement = oFormElement.elements.namedItem("result");
        const formData = new FormData(oFormElement);
        try {
            const response = await fetch(oFormElement.action, {
                method: 'post',
                body: formData
            });
            if (response.ok) {
                window.location.href = '/';
            }
            resultElement.value = 'Result:' + response.status + ' ' + response.statusText;

        } catch (error) {
            console.error('Error:', error);
        }
    }

</script>